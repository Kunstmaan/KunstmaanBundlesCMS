var Nav4=((navigator.appName=="Netscape")&&(parseInt(navigator.appVersion)==4));var dialogWin=new Object();function openDGDialog(d,f,b,e,c){if(!dialogWin.win||(dialogWin.win&&dialogWin.win.closed)){dialogWin.returnFunc=e;dialogWin.returnedValue="";dialogWin.args=c;dialogWin.url=d;dialogWin.width=f;dialogWin.height=b;dialogWin.name=(new Date()).getSeconds().toString();if(Nav4){dialogWin.left=window.screenX+((window.outerWidth-dialogWin.width)/2);dialogWin.top=window.screenY+((window.outerHeight-dialogWin.height)/2);var a="screenX="+dialogWin.left+",screenY="+dialogWin.top+",resizable=no,width="+dialogWin.width+",height="+dialogWin.height}else{dialogWin.left=(screen.width-dialogWin.width)/2;dialogWin.top=(screen.height-dialogWin.height)/2;var a="left="+dialogWin.left+",top="+dialogWin.top+",resizable=no,width="+dialogWin.width+",height="+dialogWin.height}dialogWin.win=window.open(dialogWin.url,dialogWin.name,a);dialogWin.win.focus()}else{dialogWin.win.focus()}}function deadend(){if(dialogWin.win&&!dialogWin.win.closed){dialogWin.win.focus();return false}}var IELinkClicks;function disableForms(){IELinkClicks=new Array();for(var c=0;c<frames.length;c++){for(var b=0;b<frames[c].document.forms.length;b++){for(var a=0;a<frames[c].document.forms[b].elements.length;a++){frames[c].document.forms[b].elements[a].disabled=true}}IELinkClicks[c]=new Array();for(b=0;b<frames[c].document.links.length;b++){IELinkClicks[c][b]=frames[c].document.links[b].onclick;frames[c].document.links[b].onclick=deadend}frames[c].window.onfocus=checkModal;frames[c].document.onclick=checkModal}}function enableForms(){for(var c=0;c<frames.length;c++){for(var b=0;b<frames[c].document.forms.length;b++){for(var a=0;a<frames[c].document.forms[b].elements.length;a++){frames[c].document.forms[b].elements[a].disabled=false}}for(b=0;b<frames[c].document.links.length;b++){frames[c].document.links[b].onclick=IELinkClicks[c][b]}}}function blockEvents(){if(Nav4){window.captureEvents(Event.CLICK|Event.MOUSEDOWN|Event.MOUSEUP|Event.FOCUS);window.onclick=deadend}else{disableForms()}window.onfocus=checkModal}function unblockEvents(){if(Nav4){window.releaseEvents(Event.CLICK|Event.MOUSEDOWN|Event.MOUSEUP|Event.FOCUS);window.onclick=null;window.onfocus=null}else{enableForms()}}function checkModal(){setTimeout("finishChecking()",50);return true}function finishChecking(){if(dialogWin.win&&!dialogWin.win.closed){dialogWin.win.focus()}};