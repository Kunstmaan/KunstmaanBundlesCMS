parameters:
    kunstmaan_dashboard.widget.googleanalytics.command: Kunstmaan\DashboardBundle\Command\GoogleAnalyticsDataCollectCommand
    kunstmaan_dashboard.widget.googleanalytics.controller: Kunstmaan\DashboardBundle\Controller\GoogleAnalyticsController
    kunstmaan_dashboard.googleclient.class: 'Google_Client'
    google.api.app_name: 'Kuma Analytics Dashboard'

services:
    Kunstmaan\DashboardBundle\Manager\WidgetManager: ~

    Kunstmaan\DashboardBundle\Widget\DashboardWidget:
        arguments:
            - '%kunstmaan_dashboard.widget.googleanalytics.command%'
            - '%kunstmaan_dashboard.widget.googleanalytics.controller%'
            - '@Symfony\Component\DependencyInjection\ContainerInterface'
        tags:
            - { name: kunstmaan_dashboard.widget, priority: 1 }

    kunstmaan_dashboard.googleclient:
        class: '%kunstmaan_dashboard.googleclient.class%'
        calls:
          - [ 'setApplicationName', [ '%google.api.app_name%' ] ]
          - [ 'setClientId', [ '%google.api.client_id%' ] ]
          - [ 'setClientSecret', [ '%google.api.client_secret%' ] ]
          - [ 'setDeveloperKey', [ '%google.api.dev_key%' ] ]
          - [ 'setScopes', [ 'https://www.googleapis.com/auth/analytics.readonly' ] ]
          - [ 'setUseObjects', [ true ] ]

    Kunstmaan\DashboardBundle\Helper\Google\ClientHelper:
        arguments:
          - '@kunstmaan_dashboard.googleclient'
          - '@Symfony\Component\Routing\RouterInterface'
          - 'KunstmaanDashboardBundle_setToken'

    Kunstmaan\DashboardBundle\Helper\Google\Analytics\ServiceHelper:
        arguments:
          - '@Kunstmaan\DashboardBundle\Helper\Google\ClientHelper'

    Kunstmaan\DashboardBundle\Helper\Google\Analytics\ConfigHelper:
        arguments:
          - '@Kunstmaan\DashboardBundle\Helper\Google\Analytics\ServiceHelper'
          - '@Doctrine\ORM\EntityManagerInterface'

    Kunstmaan\DashboardBundle\Helper\Google\Analytics\QueryHelper:
        arguments:
          - '@Kunstmaan\DashboardBundle\Helper\Google\Analytics\ServiceHelper'
          - '@Kunstmaan\DashboardBundle\Helper\Google\Analytics\ConfigHelper'
