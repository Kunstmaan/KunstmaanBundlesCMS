parameters:
    kunstmaan_translator.menu.adaptor.class: Kunstmaan\TranslatorBundle\Service\Menu\TranslatorMenuAdaptor
    kunstmaan_translator.service.exporter.csv.class: Kunstmaan\TranslatorBundle\Service\Command\Exporter\CSVFileExporter
    kunstmaan_translator.toolbar.collector.translator.class: Kunstmaan\TranslatorBundle\Toolbar\TranslatorDataCollector

services:
    Kunstmaan\TranslatorBundle\Service\Menu\TranslatorMenuAdaptor:
        tags:
            -  { name: 'kunstmaan_admin.menu.adaptor' }

    Kunstmaan\TranslatorBundle\Service\Command\AbstractCommandHandler:
        abstract: true
        calls:
            - [setManagedLocales, ['%kuma_translator.managed_locales%']]
            - [setKernel, ['@kernel']]

    Kunstmaan\TranslatorBundle\Service\Command\Importer\ImportCommandHandler:
        parent: Kunstmaan\TranslatorBundle\Service\Command\AbstractCommandHandler
        calls:
            - [setTranslationFileExplorer, ['@Kunstmaan\TranslatorBundle\Service\TranslationFileExplorer']]
            - [setImporter, ['@Kunstmaan\TranslatorBundle\Service\Command\Importer\Importer']]

    Kunstmaan\TranslatorBundle\Service\Command\Exporter\ExportCommandHandler:
        parent: kunstmaan_translator.service.abstract_command_handler
        calls:
            - [setTranslationRepository, ['@Kunstmaan\TranslatorBundle\Repository\TranslationRepository']]
            - [setExporter, ['@Kunstmaan\TranslatorBundle\Service\Command\Exporter\Exporter']]

    Kunstmaan\TranslatorBundle\Service\Command\Exporter\Exporter: ~

    Kunstmaan\TranslatorBundle\Service\Command\Exporter\YamlFileExporter:
        tags:
            - { name: 'translation.exporter', alias: 'yml' }

    Kunstmaan\TranslatorBundle\Service\Command\Exporter\CSVFileExporter:
        tags:
            - { name: 'translation.exporter', alias: 'csv' }

    Kunstmaan\TranslatorBundle\Service\TranslationFileExplorer:
        calls:
            - [setFileFormats, ['%kuma_translator.file_formats%']]

    Kunstmaan\TranslatorBundle\Service\Command\Importer\Importer:
        calls:
            - [setTranslationGroupManager, ['@Kunstmaan\TranslatorBundle\Service\TranslationGroupManager']] # default, maken via config var

    Kunstmaan\TranslatorBundle\Service\TranslationGroupManager:
        calls:
            - [setTranslationRepository, ['@Kunstmaan\TranslatorBundle\Repository\TranslationRepository']]

    Kunstmaan\TranslatorBundle\Service\Translator\Loader:
        tags:
            - { name: 'translation.loader', alias: 'database' }
        calls:
            - [setTranslationRepository, ['@Kunstmaan\TranslatorBundle\Repository\TranslationRepository']]

    Kunstmaan\TranslatorBundle\Service\Translator\ResourceCacher:
        calls:
            - [setDebug, ['%kuma_translator.debug%']]
            - [setCacheDir, ['%kuma_translator.cache_dir%']]
            - [setLogger, ['@Psr\Log\LoggerInterface']]

    Kunstmaan\TranslatorBundle\Service\Translator\CacheValidator:
        calls:
            - [setCacheDir, ['%kuma_translator.cache_dir%']]
            - [setTranslationRepository, ['@Kunstmaan\TranslatorBundle\Repository\TranslationRepository']]

    Kunstmaan\TranslatorBundle\Service\Translator\Translator:
        arguments:
            - '@Symfony\Component\DependencyInjection\ContainerInterface'
            - '@translator.selector'
            - {}
            - { cache_dir: '%kuma_translator.cache_dir%', debug: '%kuma_translator.debug%' }
            - ['@Symfony\Component\HttpFoundation\Session\SessionInterface']
        calls:
            - [setTranslationRepository, ['@Kunstmaan\TranslatorBundle\Repository\TranslationRepository']]
            - [setResourceCacher, ['@Kunstmaan\TranslatorBundle\Service\Translator\ResourceCacher']]

    Kunstmaan\TranslatorBundle\Service\Migrations\MigrationsService:
        calls:
            - [setTranslationRepository, ['@Kunstmaan\TranslatorBundle\Repository\TranslationRepository']]
            - [setEntityManager, ['@doctrine.orm.default_entity_manager']]

    Kunstmaan\TranslatorBundle\Service\Command\DiffCommand: ~

    Kunstmaan\TranslatorBundle\Toolbar\DataCollectorTranslator:
        arguments:
            - '@Kunstmaan\TranslatorBundle\Service\Translator\Translator'

    Kunstmaan\TranslatorBundle\Toolbar\TranslatorDataCollector:
        parent: Kunstmaan\AdminBundle\Helper\Toolbar\AbstractDataCollector
        arguments:
            - '@Kunstmaan\TranslatorBundle\Toolbar\DataCollectorTranslator'
            - '@Symfony\Component\Routing\RouterInterface'
        tags:
            - { name: kunstmaan_admin.toolbar_collector, template: 'KunstmaanTranslatorBundle:Toolbar:translations.html.twig', id: kuma_translation}
