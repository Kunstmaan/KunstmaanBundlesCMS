UPGRADE FROM 5.6 to 5.7
=======================

General
-------

* We don't enable the templating component by default anymore. If you use the templating component or the `@templating` service, run `composer req symfony/templating` and activate it by enabling the `framework.templating` config in your project.
* Update your database schema after the upgrade to have the latest entity changes applied to your database.

AdminBundle
------------

* Validator\Constraints\PasswordRestrictions have had their error constant values changed from integer to string uuid's because integers have been deprecated by Symfony.
* Passing an instance of `\Doctrine\Common\Cache\Cache` as the second argument in `\Kunstmaan\AdminBundle\Helper\VersionCheck\VersionChecker::__construct` and `\Kunstmaan\AdminBundle\Toolbar\BundleVersionDataCollector::__construct` is deprecated, an instance of `\Symfony\Component\Cache\Adapter\AdapterInterface` will be required.

GeneratorBundle
----------

* The task `npm run buildCmsAssets` is removed from the generated frontend build setup. This task is a remainder of old rework and does not work anymore with the new bundles setup. If you want to extend the Javascript functionality of the CMS, you can use the `admin-bundle-extra.js` in the `/assets/admin/js` directory.

MediaBundle
------------

* The controller method "KunstmaanMediaBundle_media_bulk_upload_submit" is now POST only.
This call now also requires a mandatory header called "x-upload-token". The content of this header
should be a csrf token generated by the Symfony csrf service using the name "bulk-upload-media".
This header is an added security layer to avoid unintended and malicious uploads.
* Validator\Constraints\Media and Validator\Constraints\HasGuessableExtension have had their error constant values changed from integer to string uuid's because integers have been deprecated by Symfony.
* All code related to the Aviary image editing service is deprecated because the service is discontinued.

MultiDomainBundle
-----------------

* The `$rootNode` property on class `Kunstmaan\MultiDomainBundle\Helper\DomainConfiguration` is deprecated and the `$rootNodeCache` property should be used instead.

NodeBundle
----------

* The method "Kunstmaan\NodeBundle\Repository\NodeTranslationRepository::getNodeTranslationByNodeIdQueryBuilder" is deprecated and will be removed in 6.0. Use the renamed method "Kunstmaan\NodeBundle\Repository\NodeTranslationRepository::getNodeTranslationByNodeId" instead.
* Setter injection and the `setContainer` method are deprecated in `Kunstmaan\NodeBundle\Helper\Services\PageCreatorService` and `Kunstmaan\NodeBundle\Helper\Services\ACLPermissionCreatorService`, inject the required dependencies in the constructor instead.

NodeSearchBundle
----------------

* The "renderCustomSearchView", "renderDefaultSearchView" and "removeHtml" methods of the "Kunstmaan\NodeSearchBundle\Configuration\NodePagesConfiguration" class are deprecated and will be removed in 6.0. Use the "Kunstmaan\NodeSearchBundle\Services\SearchViewRenderer" service instead.

UserManagementBundle
------------

* Using the deleteAction method from the UsersController is deprecated since KunstmaanUserManagementBundle 5.6 and will be replaced by the method deleteFormAction in KunstmaanUserManagementBundle 6.0. Use the correct method instead. The new action is POST only and will have correct csrf protection.
